#include"../include/HccaBlas.h"

/********************************************************************* 
 * FLOPMATVECFULL : Calculo do numero de flops da operacao de matiz  * 
 * por um vetor, onde a matriz e uma matriz densa                    * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * nLin -> numero de linhas                                          * 
 * nCol -> numero de colunas                                         * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 * Numero de flops                                                   * 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
long flopMatVecFull(int const nLin,int const nCol){
  return nLin*(2*nCol-1);
}
/*********************************************************************/ 

/********************************************************************* 
 * DOT: produto interno entre dois vetores                           * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * x1 - vetor x1                                                     * 
 * x2 - vetor x2                                                     * 
 * n  - numero de dimensoes                                          * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *                                                                   * 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
double dot(double *x1, double *x2, int const n)
{
  int i;
  double tmp=0.0;
  for(i = 0; i < n; i++)
    tmp += x1[i]*x2[i];
  return tmp;
} 
/*********************************************************************/ 

/*==================================================================*/

/*======================== level 2 =================================*/

/********************************************************************* 
 * MATVECFULL : operacao matriz vetor para matriz cheias             * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * a  - vetor a                                                      * 
 * x  - vetor b                                                      * 
 * y  - indefinido                                                   * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 * y  - produto vetoria entre a e b                                  * 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
void matVecFull( double *a
               , double *x
               , double *y
               , int const nLin , int const nCol
               , short const code)
{
  int i,j;
  double tmp;

/*... */  
  if(code){
    for(i=0;i<nLin;i++){
      tmp = 0.0;
      for(j=0;j<nCol;j++){
        tmp += MAT2D(i,j,a,nCol)*x[j];
      }
      y[i] = tmp;
    }
  }
/*...................................................................*/

/*... matriz transposta*/  
  else{
    
    for(i=0;i<nLin;i++){
      tmp = 0.0;
      for(j=0;j<nCol;j++){
        tmp += MAT2D(j,i,a,nLin)*x[j];
      }
      y[i] = tmp;
    }

  }
/*...................................................................*/
}
/*********************************************************************/ 


